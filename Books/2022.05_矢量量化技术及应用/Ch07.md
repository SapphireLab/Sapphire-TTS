# 矢量量化在语音信号处理中的应用

## 1.语音信号分析与处理简介

语音信号处理是研究用数字信号处理技术对语音信号进行处理的一门新兴交叉学科[351], 涉及到语言学, 语音学, 生理学, 心理学, 认知科学, 数字信号处理, 模式识别和人工智能等众多学科领域. 语音信号处理技术是当前信息高速公路, 多媒体技术, 办公自动化, 现代通信及智能系统的核心技术之一. 语音信号处理的目的是得到某些特征参数以便实现语音信号的高效传输与存储, 或者为了人工合成语音, 辨识说话者, 识别语音内容以及增强语音等. 语音信号处理包括语音通信, 语音合成, 语音识别, 说话人识别和语音增强等方面. 语音信号处理离不开语音信号分析, 语音信号分析是语音信号处理的基础. 语音信号处理需要用到潘音信号分析所得到的参数. 下面各小节简要叙述语音信号的特点, 时域分析, 频域分析, 同态分析和线性预测分析等问题. 

### 1.1.语音信号

通过语音传递信息是人类最重要的基本功能之一. 虽然人类可通过多种手段从外界获取信息, 但是最重要, 最精细的信息源只有语言, 图像和文字. 与用声音传递信息相比, 用视觉和文字传递信息效果要差得多. 语言是人类最重要, 最有效, 最常用和最方便的信息交换形式. 另一方面, 语音和语言与人的智力活动密切相关, 与文化和社会进步紧密相连. 
人类的语音是一种特殊的声音, 是人讲话所发出的声音. 语音由一连串音构成, 这些音的分类和研究属于语音学的范畴. 形成文章的基础是单词, 也称词, 它是有意义的语言的最小单位. 各单词由音节组成, 音节又由音素组成. 音素是语言的元素, 即语言的最小单位. 也就是说, 音素都有其独立的各不相同的发音方法和发音部位, 它是让听者能区别一个单词和另一个单词的声音的基础. 音素分为元音和辅音两类. 目前存在的各种语言的元音个数少至两个多至12个, 辅音则从10多个至70多个. 英语中有43个音素. 重音, 评调和声调也是语言学的一部分, 它们或者用来表示一句话中重要的单词, 或者用来表示疑问句, 或者用来表示说话人的感情. 语音中还有一个问题是同音异义词, 如汉语中的“语”, “与”, “雨”, 英语中的 “site”, "sight", "cite”等就是同音异义词. 

人的发音器官包括肺, 气臂, 喉 (包括声带) , 咽, 鼻和口等. 这些器官共同形成一条形状复杂的管道, 其中喉以上的部分称为声道, 随着发出声音的不同其形状是变化的, 而喉的部分称为声门. 产生语音的能量来源于正常呼吸时肺部呼出的稳定气流, 喉部的声带即是对发普影响很大的器官, 声带的声学功能是为语音提供主要的激励源. 两声带之间的部分称为声门. 呼吸时左右声带打开, 讲话时声带先合拢起来, 然后受声门下气流的冲击而张开, 最后由于声带具有韧性而迅速闭合. 声带的不断开启和闭合使气流形成一系列脉冲. 每开启和闭合一次的时间即振动周期称为音调周期, 其倒数称为基音频率, 简称基频, 它决定音调的高低. 基音的范围为70~350Hz, 它随发音人的性别, 年龄及具体情况而定, 老年男性偏低, 小孩和青年女性偏高. 语音由声带振动或不经声带振动来产生, 其中由声带振动产生的音统称为浊音, 而不由声带振动产生的音统称为清音. 独浊音中包括所有的元音和一些辅音, 而清音中包括另一部分辅音. 声道是由咽, 口腔和鼻腔组成, 它是一根从声门延伸到口唇的非均匀截面的声管, 其外形变化是时间的函数, 它是气流自声门, 声带之后最重要的, 对发音起决定作用的器官, 发不同音时其形状变化是非常复杂的. 声道可看作一个分布拳数系统, 它是一个谐振腔, 其作用是放大某些频率分量而衰减其他频率分量. 谐振频率由每一瞬间的声道外形决定. 若声道的截面是均匀的, 则谐振频率发生在

式中, c为声速, L为声道长度, n表示谐振频率的序号. 通常, 成年男子声道的平均长度约17cm, 则谐振频率发生在500Hz的奇数倍上, 即F: =500Hz, Fz-1500Hz, 
*. 这些谐振频率称为共振峰频率, 简称共振峰, 它是声道的重要声学特性. 当声音沿着声管传播时, 其频谱形状就会随声管截面积的变化而改变. 根据上述介绍, 语音的特性完全由声门, 声道和口鼻决定. 语音信号的产生模型如图7-1所示. 

下面简单讨论语音信号的数字模型, 它包括激励模型, 声道模型和辐射模型. 首先讨论激励模型. 发浊音时, 由于声带不断张开和关闭, 从而产生间歇的脉冲波. 根据测量结果, 这个脉冲波类似于斜三角形的脉冲, 此时的激励信号是一个以基音周期为周期的斜三角脉冲串. 单个三角波的数学表达式如下: 

式中, N, 为斜三角波上升部分的时间, Nz为其下降部分的时间. g (n) 的频谱G (z) 是一个低通滤波器, 它可表示为如下的全极模型形式: G (z) =-e-cz-リ
 (7-2) 式中C是一个常数. 显然, 上式表明斜三角波可描述为一个二极点模型. 整个斜三角脉钟可看作加权的单位脉冲串激励上述单个斜三角脉冲的结果. 而该单位脉冲串及幅值因子可表示成下面的乙变换形式: 
E (z) -1z=
 (7-3) 所以整个浊音的激励模型可表示为
U (z) =G (z) E (z) =1一是五'1-e-cTz=i
 (7-4) 

发清音时, 声道被阻碍形成揣流, 激励模型可模拟成随机白噪声, 实际上可使用均值为0, 方差为1, 并在时间上或在幅度上为白色分布的序列. 关于声道糗型, 目前有两种观点: 一是将声道视为有多个不同截面积的管子申联而成的系统, 由此推导出“声管模型”; 二是将声道视为谐振腔, 由此推导出“共振峰模型”. 在声管模型中, 每个串联的管子可看作一个四端口网络, 这个网络具有反射系数, 这些系数和下面要介绍的线性预测参数之间有惟一的对应关系. 因此, 声道可由一组截面积或一组反射系数来表示. 在共振峰棋型中, 声道被看作谐振腔, 共振峰就是该腔体的谐振频率. 由于人耳听觉的纤毛细胞就是按频奉感受而排列位置的, 故这种模型非常有效. 实践表明, 用前三个共振峰来代表一个元音已经足够; 对于较复杂的辅音或鼻音, 大概要用五个以上的共振峰才行. 基于共振峰理论, 可建立三种实用的模型: 级联型, 并联型和混合型. 声道模型的传递函数通常用V (z) 表示, 例如一般元音的全极点声道模型的传递函数为

限于篇幅, 在此不作详细讨论. 感兴趣者可参考有关语音信号处理的文献. 声道的终端为口和唇. 从声道输出的是速度波, 而语音信号是声压波, 两者的倒比称为辐射参数Zz. 它表示口和唇的辐射效应, 也包括圆形的头部的绕射效应. 研究表明, 口屑端辎射模型是一阶高通滤波器, 可表示为

由上述分析可知, 完整的语音信号数字模型可用激励模型, 声道模型和辐射模型三个子模型的串联来表示, 其传递函数为H (z) =U (z) V (z) R (z) 
 (7-7) 语音信号统计特性的研究表明, 其幅度分布的概率密度有两种近似表达式. 较
好的是修正伽玛概率密度
f (x) =Vk.e-kis1
2~x/ェ|
 (7-8) 精度稍差一点的是拉普拉斯 (Laplacian) 分布f (x) =0.5ae*lz
 (7-9) 对语音通信系统的总评价是对所收到的语音信号的质量的评价, 即所传出的语音能正确无误接收的比例, 称为语音清晰度或可懂度. 理论上, 语音质量测试可分为两类: 一类是音节以下 (如音素, 声母, 韵母) 的语音单元测试, 常称为“清晰度”测试; 清晰度测试可以元音, 辅音为基础或以声母, 韵母为基础, 再根据音节成分计算音节清晰度. 另一类是音节以上 (如词, 句) 的语音单元的测试, 常称为“可懂度’测试. 这些测试的基本原理是相同的, 只是测试的单元有所不同; 而且可根据条件用公式从小单元的清晰度计算出大单元的可懂度来. 这些测试都属于主观听觉的测试方法, 即以人的测听效果为依据. 

### 1.2.语音信号的时域分析

进行语音信号分析时, 最先接触到且最直观的就是它的时域波形. 时域分析通常用于最基本的参数分析, 语音的分割, 预处理和大分类. 这种分析方法的特点是: 
 (1) 表示语音信号比较直观, 物理意义明确;  (2) 实现起来比较简单, 运算量少; 
 (3) 可得到语音的一些重要参数;  (4) 可采用示波器等通用设备进行观测, 与时域分析密切相关的是语音信号的数字化和预处理. 为将原始的棋拟语音信号变为数字信号, 必须经过取样和量化两个步骤, 从而得到时间上和幅度上均离散的数字语音信号. 根据取样定理, 当取样率大于信号的两倍带宽时, 取样过程不会丢失信息, 且从取样信号中可精确地重构原始信号波形. 由于电话语音的频率范围大约是60~3400Hz, 故取样率一般取8kHz. 为实现高质量的语音合成和语音识别时的高识别率, 某些现代语音处理系统的取样率提高到12~20kHz. 取样之后要对信号进行量化, 而量化过程不可避免地会产生误差, 量化后的信号值与原信号之间的差值称为量化误差或量化噪声. 有关语音信号标量量化的量化噪声在第一章中曾分析过, 在此不再重复. 在对语音信号进行分析和处理之前, 往往还需要进行预处理. 预处理除数字化之外, 还包括放大及增益控制, 抗混叠滤波, 预加重等. 在需要语音输出的场合, 需要进行数模转换和起平滑作用的模拟低通滤波. 图7-2为一般的语音数字分析和处理系统框图. 图中, A/D转换前需要加一个抗混叠滤波器, 其截止频率由语音信号带宽决定, 并应保证其带内波动和带外衰减特性尽可能
好. D/A后面的低通滤波器是平滑滤波器, 对重构的语音信号的高次谐波起平滑作用以去除高次谐波失真. 由于语音信号的平均功率谱受声门激励和口鼻辐射的影响, 高频端大约在800Hz之后按6dB/倍频程跌落, 为此要在预处理中进行预加重, 其目的是提升高频部分, 使信号的频谱变得平坦, 以便进行频谱分析或声道参数分析. 加重后的信号在分析处理后必须进行去加重处理. 

用于语音分析全过程的技术是“短时分析技术”. 语音信号的特性随时间而变化, 它是一个非平稳过程. 从另一方面来看, 虽然语音信号具有时变特性, 但在一个较短时间范围内其特性基本保持不变, 故它可看作一个准稳态过程. 由于语音信号具有“短时性”, 故人们对语音的分析处理必须建立在“短时”的基础上, 即将语音分成一段一段进行分析, 其中每一段称为一帧. 语音信号的一帧一般为10~30ms.语
音的时域分析通常包括: 短时能量分析, 短时过零分析和短时相关分析三个方面. 


#### 1.2.1.短时能量分析

由于语音信号能量随时间有相当大的变化, 故人们通常对语音信号进行能量分析. 清音段的能量一般比浊音段的能量小得多. 能量分析包括能量和幅度两个方面. 在分析时, 通常采用可移动的有限长度窗口w (n) 进行加权. 最简单的窗口为矩形窗, 即

当然也可采用其他形式的窗口进行分帧. 短时平均能量可定义为E. =
S[x (m) w (n-m) ]=2[x (m) w<n-m) ]
 (7-11) 式 (7-10) 也可写成
E.=Sr (m) h (n-m) =x*<n) #h (n) 
 (7-12) 即短时平均能量E. 相当于语音信号平方通过一个单位函数响应为h (n) 的线性滤波器的输出. 窗口形状和大小将决定短时能量的特性. 如矩形窗的谱平滑较好, 但波形细节丢失, 而汉明窗则相反. 不论什么样的窗, 如果窗长度N很大, 它等效为很窄的低通滤波器, 此时E随时间变化很小, 不能反映语音信号的幅度变化, 波形的变化细节就看不出来; 反之, N太小时, 滤波器的通带变宽, 短时能量随语音信
号波形变化而缓慢地变化. 短时能量分析的主要用途是: 
 (1) 可以区分清音段与浊音段, 因为独音的£. 比清音大得多. 
 (2) 可以用来区分声母与韵母的分界, 无声与有声的分界, 连字的分界. 
 (3) 作为一种超音段信息, 用于语音识别中. 但是, E. 值对于高电平信母号非常敏感. 为此, 可采用另一种度量语音信号幅度值变化的函数, 即“短时平均幅度M.”, 其定义为M.=lz<m>w (n-m) |=|x (n) |*w (n) 
 (7-13) 即用加权的信号绝对值之和取代平方和, 因而计算简单. 当然, 独音与清音的Mn值不如E. 值那样有明显的差异. 

#### 1.2.2.短时过零分析

过零分析是语音时域分析中最简单的一种, 顾名思义, 过零就是信号通过零值. 对于连续谱音信号, 可以考察其时域波形通过时间轴的情况. 而对于离散时间信号, 如果相邻的取样值改变符号则称为过零. 由此可计算过零数, 过零数就是样本改变符号的次数. 单位时间内的过零数称为平均过零数. 对于窄带信号, 平均过零数作为信号频率的一种简单度量是比较精确的. 然而, 语音信号是宽带信号, 故不能简单地用上面的公式计算频率. 但是, 仍然可用短时平均过零数来得到其频谱的粗略估计, 该参数定义如下; 

式中, 8gn[・]表示符号函数, w (n) 为矩形窗, 其长度为N, 而幅值为1/ (2N) , 表示对窗口范围内的过零数求平均. 短时过零分析可用于区分浊音与清音, 因为浊音的语音能量约集中于 3kHz以下, 而清音多出现在较高频率上, 高频煮味着高的平均过零数, 而低频意味着较低的平均过零数. 利用短时平均过零数还可以从背景噪声中找出语音信号, 可用于判断静音和语音的起点和终点. 


#### 1.2.3.短时相关分析

相关分析是一种常用的时域波形分析方法, 它包括自相关分析和互相关分析. 相关函数用于测定两个信号在时域内的相似性, 如利用互相关雨数, 可测定两个信号间的时间滞后或从杂音中检测信号. 如果两个信号完全不同, 则互相关函数接近于0. 如果两个信号波形相同, 则在超前, 滞后处出现峰值. 由此可求出两个信号间的相似程度. 而自相关函数用于研究信号本身的特性, 如信号波形的同步性, 周期性等. 下面讨论语音信号的自相关函数. 对于确定性信号序列, 自相关雨数定义为

对于随机性信号序列或准周期性信号序列, 自相关函数定义为R (h) = lim2N+1z (m) z (m+k) 
1ヾ
 (7-16) 自相关函数具有以下性质: 
 (1) 周期为N. 的周期序列的自相关函数也是同周期的周期函数, 即R (k) =
R (k+Np) .
 (2) 它是偶函数, 即R (k) =R (-k) . 
 (3) 当k=0时, 自相关函数具有极大值, 即R (0) >|R (k) |.
 (4) R (0) 等于确定性信号序列的能量或随机性序列的平均功率. 自相关函数的这些性质, 完全可用于语音信号的时域分析中. 例如, 发浊音时语音波形序列具有周期性, 因此可用自相关丽数求出这个周期, 即基音周期. 此外, 在进行语音信号的线性预测分析时, 也要用到自相关函数. 语音信号短时自相关函数定义为

该式可解释如下: 首先乘以窗函数来选择语音段. 然后把确定性自相关函数定义用于该语音段. 容易证明
R,  (k) =S[x (m) z (m-k) ]hs (n-m) =[z (n) z (n-k) ]*hj (n) 
 (7-18) 所以, 短时自相关函数可看作序列[x (n) z (n-k) ]通过单位函数响应为h (n) 的数宇滤波器的输出. 
需要注意, 计算自相关函数所用的窗口长度的要求与计算平均能量所用的窗
ロ长度的要求不一样. 自相关函数的计算通常要求N至少大于基音周期的2倍, 否则将拽不到第二个最大值点. 另一方面, 要求N值尽可能地小, 因为语音信号的特性是变化的, 如N过大将影响短时性. 由于基音周期的范围很宽, 所以应使窗长匹配于预期的基音周期. 长基音周期用窄的窗, 将得不到预期的基音周期; 而短基音周期用宽的窗, 自相关函数将对许多个基音周期作平均计算, 这是不必要的. 为此, 可采用自适应于基音周期的窗长, 但是计算起来比较复杂. 为解决该问题, 可采用如下修正的短时自相关函数代瞽短时自相关函数; R,  (h) -〉ょ (m) wi (n-m) x (m+k) wj (n-m-k
 (7-19) 式中, 窗w (n) 与wz (n) 的长度不一样. 严格地说, 式 (7-19) 是一个互相关函数, 因为它是两个不同长度语音段z (m) wj (n-m) 和x (m) wz (n-m) 的互相关. 

短时自相关函数是语音信号时域分析的重要参数, 但是计算自相关函数的运算量是很大的, 其原因是乘法运算所需时间较长. 为避免乘法, 一种简单方法就是利用差值. 为此, 人们常常采用另一种与自相关函数有类似作用的参量, 即短时平均幅度差函数 (AMDF) . 它能代替自相关函数进行语音分析的原因是语音的独音具有准周期性. 如果信号是完全的周期信号, 则相距为周期倍数的样值幅度是相等的, 差值为零. 实际的语音信号的AMDF值不为零, 但很小. 这些极值点将出现在整数倍周期的位置上. 因此, 人们可定义短时平均幅度差函数为F. (h) -1S|z (m) w. (n-m) -ェ (m+k) w (n-m-k) | (7-20'式中R为信号x (n) 的平均值. AMDF 已经用于许多实时语音处理系统中. 

### 1.3.语音信号的频域分析

从广义上讲, 语音信号的频域分析包括语音信号的颗谱, 功率谱, 倒谱, 频谱包络等, 常用的频域分析法有带通滤波器组法, 傅里叶变换法以及线性预测法等. 傅里叶变换在信号处理中的地位举足轻重, 它通常能使信号的某些特性变得很明显, 而在原始信号中这些特性可能含混不清或不明显. 然而, 语音信号是一种非平稳信号, 因此适用于周期, 瞬态或平稳随机信号的标准傅里叶变换不能用来直接表示语音信号. 但是, 对语音处理来说, 短时分析方法是有效解决方法, 故人们可将短时分析用于傅里叶变换中, 也就是所谓的短时傅里叶变换, 即有限长度的傅里叶变换. 通常认为语音信号是局部平稳的, 所以可对一帧语音进行傅里叶变换, 即短时傅里叶变换, 其定义为

由定义可知, 短时傅里叶变换是窗选语音信号的标准傅里叶变换. 这里用下标n区别于标准的傅里叶变换. 所以短时傅里叶变换有两个自变量n和@. 若令w=
2kx/N, 则可得到离散的短时傅里叶变换
X. (ejkmN) =X. (k) -2x (m) w (n-m) e-jkmm1N
 (7-22) 式中, 0<k<N-1. 它实际上是X,  (e") 的频域取样. 由上面两个式子的定义可以看出, 这两个公式都有两种解释: 
 (1) 当n固定不变时, 它们分别是序列w (n-m) x (m)  (-0o<m<*o) 的标准傅里叶变换和标准离散傅里叶变换. 此时X,  (e*) 与标准傅里叶变换具有相同性质, 而X.  (k) 与标准的离散傅里叶变换具有相同的特性. 
 (2) 当w或k固定时, X. (e") 与Xn (k) 都是时间n的雨数. 它们是信号序列和窗口函数序列的卷积, 此时窗口的作用相当于一个滤波器. 上面给出了语音信号的短时谱. 而由X,  (e") 恢复r (n) 的过程称为短时傅里

叶逆变换. 由于X,  (e*) 是n和w的二维函数, 因而如何选择X. (e) 在时域和频域内的取样率是一个基本问题, 它们应使z (n) 可由非混叠的X,  (e") 准确恢复. 当w固定时, X. (e*) 是一个单位函数响应为w (n) 的低通滤波器的输出. 设低通谑波器带宽为B (Hz) , 则X,  (e") 具有与窗相同的带宽. 根据取样定理, X,  (e") 的时域取样率至少为2B才不至于出现混叠. 而低通滤波器的带宽由W (e") 的第一个零点位置决定, 该零点位置由窗函数的类型决定. 设f, 为x (n) 的取样率, 窗长度为N, 则可以证明矩形窗的带宽为f/N, 而汉明窗的带宽为2f, /N. 于是时域取样率应为

另一方面, 当n为固定值, X,  (e") 为序列z (n) w<n-m) 的傅里叶变换. 为用数字方法得到z (n) , 必须对X,  (e~) 进行频域取样. 由于X,  (e们) 是关于w的周期为2m的周期函数, 因此取样只需在2m内等间隔地进行. 设取样点为L, 则各取样点频率值为

式中, 0<k<N-1, L为取样频率, 它可大于或小于信号长度N, 通常取L=N. 根
据上述讨论, 可得由X. (e叫) 恢复x (n) 所需的总取样率 SR为

当L=N时, 矩形窗SR-2f.i汉明窗SR=4f.. 即短时谱表示所要求的取样率比原信号本身的时域取样率f.要高2倍或4倍. 求短时傅里叶逆变换的方法主要有两种: 滤波器组求和法与快速傅里叶变换求和法. 限于篇幅, 在此不作介绍, 感兴趣的读者可参阅有关文献
上述两节给出了语音的时域分析和频域分析. 这两种方法均有局限性, 时域分析对语音信号的频域特性没有直观的了解; 而频域特性中又无法给出语音信号随时间的变化关系. 因此, 人们致力于研究语音的时间依赖于傅里叶分析的方法, 所得到的图形通常称为语谱图, , 它表示谱音频谱随时间变化的图形, 其纵轴为频率, 横轴为时间. 任一给定频率成分在给定时刻的强弱用相应点的黑白度即色调的浓淡来表示. 目前, 已经有专门的语谱分析仪, 它可用于识别说话者, 这是因为不同人说话的语谱图的黑白程度不同, 形成不同的纹路, 称为“声纹”. 

### 1.4.语音信号的同态分析

语音信号的产生模型可看作声门激励信号和声道冲激响应的卷积. 在语音信号处理领域中, 利用语音信号求解声门激励或声道冲激响应具有非常重要的意义. 由卷积结果求得参与卷积的各个信号是数字信号处理各个领域普遍遇到的一项共同任务, 这个问题称为“解巻”. 解卷有两种, 一种是线性预测分析, 一种是同态分析. 本小节介绍同态分析. 下一小节介绍线性预测分析. 同态信号处理也称同态滤波, 它实现了将卷积关系或乘积关系变换为求和关系的分离处理. 众所周知, 加性信号可用线性系统来描述. 但是许多信号的各分量并不都是按加法原则组合起来的. 如语音信号, 图像信号, 地震信号等等, 它们都不是加性信号, 而是果性信号或卷积性信号. 此时不能再用线性系统, 而必须用非线性系统一一同态处理系统来处理. 同态处理大体分为乘积同态处理和卷积同态处理两种. 在语音信号处理中, 通常采用卷积同态处理模型, 如图7-3所示, 模型的输入输出都是卷积运算. 任何同态系统都可表示为三个岡态系统的级联, 如图7-4所示, 它包含一个特征系统, 一个线性系统和一个逆特征系统. 对于语音信号, 其特征系统和逆特征系统的构成分别如图7-5 (a) 和图7-5 (b) 所示. 

下面简单分析同态处理基本原理. 设输入信号为z (n) =xi (n) *Iz (n) 
 (7-26) 式中ェ (n) 和xz (n) 分别为声门激励和声道冲激响应序列. 特征系统D.将卷积性信号转化为加性信号. 它包含三部分, 首先进行Z变换, 将卷积性信号转换为乘性信号, 即

然后进行对数运算, 将乘积运算转变为加性运算, 即 InX (z) =InXi (z) + InXz (z) =X (z) +Xz (z) = X (z)  (7-28) 最后, 将所得到的加性对数频域信号利用Z逆变换转化为时域信号, 即 Z-'[X (z) ]=Z-1[X. (z) ]+z-1[Xz (z) ]=元 (n) +£z (n) = £ (n) 
 (7-29) 由于加性信号的2变换或逆2变换仍然为加性信号, 故这种时域信号可用线性系统处理. 经过线性系统处理后, 若要恢复卷积性信号, 可通过图7-5 (b) 所示的逆特征系统. 首先, 将线性系统输出的加性信号
D (n) =シ (n) +シz (n) 
 (7-30) 进行Z变换, 得 Z[9 (n) ]= Y (z) =P,  (%) +Yz (z) 
 (7-31) 然后, 进行指数运算, 得到乘积性信号
exp[Y (z) ]= Y (z) =Y (z) ・Yz<z) 
 (7-32) 最后, 进行Z逆变换, 得到卷积性的语音恢复信号
y (n) -z-1[Y (z) ・Yz (x) ]=y (n) *yz (n) 
 (7-33) 由式 (7-29) 可知.  (n) 是一个时域序列, 通常称£ (n) 为ェ (n) 的“复倒频谱”, 
简称复倒谱, 有时也称对数复倒谱. 同样, 序列夕 (n) 是y (n) 的复倒谱. 因此, 特征系统的作用是将时域卷积运算转换为复倒频谱域中的加性运算. 在绝大多数数字信号处理问题中, X (z) , X (z) , Y (z) , Y (z) 的收敛域均包含单位圆, 因而上面各式中的Z变换和2逆变换都可用序列的傅里叶变换 (DTFT) 及其逆变换 (IDTFT) 来代替, 即前面各式可改写为下面的形式: 

容易证明: 当x (n) 为实序列时, 其复倒谱王 (n) 也必然为实序列. 在实际应用中, 有时将式 (7-35) 和式 (7-36) 改为c (n) = IDTFT[ln|X (e) |
 (7-40) 即c (n) 是序列ェ (n) 对数幅度谱的傅里叶逆变换. 人们称c (n) 为“倒频谱”, 简称“倒
谱”, 有时也称对数倒频谱, 采用倒谱的优点是避免了复对数运算. 倒谱的量纲为

“quefrency”, 即倒频, 它是由频率 (frequency) 一词转变而来. 与复倒谱类似, 如果c,  (n) 和cz (n) 分别是z (n) 和zz (n) 的倒诸, 且ェ (n) =ェj (n) *xz (n) , 则x (n) 的倒谱为c (#) =c;  (n) +cz (n) . 与复倒谱不同的是, 在倒谱情况下一个序列经过正逆两个系统后, 不能完全恢复自身, 这是因为在计算倒谱时丢失了相位信息. 语音信号可看作是声门激励和声道冲敝响应的卷积. 下面简单介绍它们的复倒谱特性. 首先来看声门激励信号的复倒谱. 发清音时, 声门撤励能量小且为白噪声, 在此不讨论其复倒谱特性. 发浊音时, 声门激励是以基音周期为周期的冲激序列, 即

r=Q
式中, M和r是正整数, a, 是幅度因子, N, 是基音周期 (以样点数表示) . 容易证明z{n) 的复倒谱为

由此可见: 一个周期冲激的有限长度序列, 其复倒谱也是一个周期冲激序列, 而且长度N, 不变, 只是序列变为无限长度序列, 同时其振幅随着k的增大而衰减 (a, /ag<1) , 衰减速度比原序列快. 
如果用最严格的极零棋型来描述声道响应x (n) , 则其Z变换形式为

式中, |A|是X (z) 归一化后的一个实系数; |a|.|b|, |c1, |d|的值皆小于1. 可
以证明, 声道冲激响应序列的复倒谱为

其性质如下; 
 (1) £ (n) 是双边序列, 定义域-cc<n<内. 
 (2) 由于|as|, |b|, |cnl, |ds|均小于1, 故£ (n) 是衰减序列, 即i (n) 隨|n|的
増大而减小. 

 (3) £ (n) 随|n|增大而衰减的速度至少比1/|n|快, 因为|£ (n) |<c|F*/n|
 (-oo<n<oo) . 这里户是|an[, |b|, |cnl, |d, |中的最大值, c为常数. 因此,  (n) 比
z (n) 更集中于原点附近, 即 (n) 更具有短时性, 所以用短时窗提取声道响应序列的复倒谱是很有效的. 
 (4) 若x (n) 为最小相位序列, 即零极点均位于Z平面单位國内, 即b=0, ds=
0. 此时£ (n) 只在n>0时有值, 即£ (n) 为因果序列. 最后需要指出, 在复倒谱分析中, Z变换后得到的是复数, 所以取对数需进行复对数运算, 这就存在相位的多值性问题, 称为“相位卷绕”问题. 由于相位卷绕使后面求复倒谱以及由复倒谱恢复语音等运算均存在不确定性而产生错误. 这个问题通常可采用微分法和递归法解决, , 限于篇幅, 在此不再叙述, 感兴趣读者可参阅有关文献. 

### 1.5.语音信号的线性预测分析

在第二章的预测矢量量化器这一节中曾介绍线性预测原理. 线性预测这一术语是维纳于1947年首先提出的. 1967年, 板仓等人最先将线性预测技术直接应用到语音分析和合成中. 线性预测分析[95的基本思想是将被分析的信号用一个模型来表示, 即将信号看作是某一个模型的输出. 这样-来, 就可用模型参数来描述信号. 线性预测模型的系统函数可写成如下的有理分式形式: 

式中, 系数a; b及增益因子G为模型多数, 而p和q是选定的模型的阶. 若输入序列为u (n) , 输出序列为s (n) , 则输入输出之间的时域关系为
 (n) =as'n-i) +Gbju (n-l) , 
b. =1
 (7-47) 这是一个线性常系数差分方程. 该式表明, 一且模型的参数设计好以后, 就可用模型的输入及过去的信号值来估计当前的信号值. 根据H (z) 的形式不同, 有三种不同的信号模型: 
 (1) H (z) 同时含有极点和零点, 称作自回归-滑动平均模型, 简称为ARMA模型, 这是一种一般模型.
 (2) 当式 (7-45) 中的分子多项式为常数, 即b=0时, H (z) 为全极点模型, 这时模型的输出只取决于过去的信号值, 这种模型称为自回归模型, 简称AR模型. 
 (3) 如果H (x) 的分母多项式为1, H (z) 为全零点模型, 称为滑动平均模型, 简称MA模型. 此时模型的输出只由模型的输入来决定, 在语音线性预测中, 通常采用全极点模型, 这是因为: 全极点模型最容易计算, 对全极点模型作参数估计是对线性方程组的求解过程, 求解相对容易; 若不考虑鼻音和摩擦音, 那么语音的声道传递函数就是一个全极点模型. 将图7-1中的辐射, 声道以及声门激励的全部谱效应简化为一个时变的数字滤波器, 就可得到语音的全极点祺型, 其系统函数为

这样就把语音信号s (n) 模型化为一个p阶的AR 模型. 由于人们通常采用这种模型来产生合成语音, 故滤波器H (z) 亦称作合成滤波器. 这个合成模型的参数有; 浊音/清音判决, 浊音语音的基音周期, 增益常数G及数字滤波器参数a;  (也就是线性预测系数) . 目前, 线性预测的解法有三种: -种是自相关法, 一种是协方差法, 一种是格型法. 前两种方法在第二章中曾作介绍, 限于篇幅, 这里不对第三种作具体介绍. 
线性预测分析在语音信号处理中的应用主要包括LPC谐估计和LPC复倒谱估计. 当给定一组预测器系数后, 将z=e*代入H (x) , 就可得到语音产生模型的频率响应, 即

如果画出其频率响应, 则可预料到在共振峰频率上将会出现峰值, 因此线性预测分析可看作是一种短时谱估计法. 可以证明: 如果信号s (n) 是一个p阶的AR模型, 则

式中, H (e*) 是模型H (z) 的频率响应, 可简称为LPC谱; S (e*) 是谱音信号s<n) 的傅里叶变换, 即信号谱, |S (e*) |为功率谱. .线性預分析的阶数p能有效地控制所得谱的平滑度. LPC系数是线性预测分析的基本参数, 人们也可把这些系数转换为其他参数, 如复倒谱. 设

当poc时, 由于|H (e*) |*=|S (em) |, 故可认为h<n) 包含了语音信号频谱的包络信息, 即可近似把h (n) 当作s (n) 的短时复倒谱6<n) . 通过对h (n) 的分析, 可分别估计出语音短时谱包络和声门激励参数. LPC 复倒谱分析的优点是计算量小, 适合作为实时语音识别的特征参数
上面提到的模型参数都是时域参数, 下面给出语音信号线性预测分析的一种频域参数, 即线谱对参数, 简称LSP参数. LSP分析也以全极点模型为基础. 设p阶线性预测误差滤波器传递函数为A (z) , 设A (z) =A'P)  (z) 后, 它具有如下递推关系: 

它和合成滤波器H (z) 之间满足关系式A (z) =1/H (z) . 当A (z) 的零点在单位图内时, P (z) 和Q (z) 的零点都在单位圆上, 并且P (z) 和Q (x) 的零点沿眷单位圆随w的增加交替出现. 设P (z) 的零点为e, Q (z) 的零点为e网, 那么P (z) 和Q (z) 可
写成如下的因式分解形式; 



## 2.矢量量化在语音编码中的应用

前面一节简述了语音信号的各种分析方法. 
下面两节讨论语音信号处理中最重要的两方面内容, 即语音编码和语音识别, 而不考虑语音增强和语音合成等其他语音处理, 这是因为目前矢量量化技术主要应用在语音编码和语音识别等领域. 
本节讨论语音编码或语音压缩问题. 

### 2.1.语音信号的压缩编码原理

将语音信号编码为二进制序列, 最简单的方法就是对其直接进行模数转换; 
只要采样率足够高, 量化每个样本的比特数足够多, 则可保证解码恢复的语音信号有很好的音质, 不会丢失有用信息. 
然而对语音信号直接数字化所需的码速率太高, 例如普通电话通信中采用 8kHz 取样率, 如用 12 比特进行量化, 则码速率高达 96kbit/s. 
这么大的码速率即使对大容量的传输信道也是难以承受的, 因此必须对语音信号进行压缩编码. 

对语音信号进行压缩编码的基本依据有两个. 

A. 一个是从产生语音的物理机制和语言结构来看, 语音信号中存在较大的冗余度. 
语音压缩实质上就是识别这些冗余度并设法去掉它们. 
冗余度大致表现在以下几个方面: 
1. 语音信号采样间的相关性很强, 即其短时谱不平坦;
2. 浊音语音段具有准周期性;
3. 声道的形状及其变化比较缓慢;
4. 传输码值的概率分布是非均匀的. 

前三种冗余度是由语音信号的产生机理决定, 而后一种则与所用的编码方法有关. 
第 1 种冗余可通过滤波来去除, 第 3 种冗余是语音分帧处理的基础. 
概率编码方法通常利用第 4 种冗余度进行压缩. 

B. 语音编码的第二个依据是利用人类听觉的某些特点. 
从听觉器官的物理机制来看, 人所能听到声音的动态范围和带宽受到限制. 
比如, 存在听觉掩蔽现象, 即一个强的音能够抑制另一个同时存在的弱的音. 
利用这一性质可抑制与信号同时存在的量化噪声. 
利用人类在语音听觉上的制约, 可压缩表示语音信号的必要信息, 从而降低传输速率, 

语音编码大致可分为两类. 
- 一类是波形编码, 即针对语音波形进行编码, 而尽量保持输入波形不变, 即恢复的语音信号基本上与输入语音信号波形相同. 
这类编码方法具有自适应能力强, 语音质量好的优点, 但是所需的编码速率较高, 否则编码质量将大大下降. 
在波形编码中, 要求重构语音的各样本尽可能接近原始语音的样值. 
令 $e(n)=\hat{s}(n) - s(n)$ 表示重构误差, 则波形编码的目的是在给定传输比特率的条件下使 $e(n)$ 最小, 因而在这种方法中信噪比是评定语音质量的标准.
- 另一类语音编码方法是参数编码, 有时也称声码器技术, 它先对语音信号进行分析, 提取出器参数, 对参数进行编码, 用解码后的参数重新合成出重构的语音信号, 使得到的信号听起来与输入语音相同, 而不是对语音信号的波形直接处理, 因而恢复信号与原信号不必保持波形相同.
声码器中解码后合成的语音信号与原始语音信号之间没有一一对应关系, 因而音质的好坏要由主观进行评价, 而缺乏客观标准.
声码器语音的自然度, 可懂性差, 较少地保留讲话人的特征, 受噪声和误码的影响大, 算法复杂.

矢量量化在语音编码中已经得到较好的应用.
例如, 若在原来编码速率为 2.4kbit/s 的线性预测声码器的基础上, 将每帧的 10 个反射系数加以 10 维的矢量量化, 即可使编码速率降低到 800bit/s 而声音质量基本未下降.
又如分段声码器, 由于采用矢量量化, 可使码速率降低到 150bit/s.

下面分别介绍传统的语音波形编码和参数编码以及矢量量化技术在这两个方面的应用.

### 2.2.语音信号的波形编码

#### 2.2.1.基于 PCM 的语音编码

波形编码方式的最简单形式是**脉冲编码调制 (Pulse Code Modulation, PCM)**.
它是用同样的量化级数进行量化, 即采用最基本的标量量化, 即**均匀量化**. 
这种方式将语音变换成与其幅度成正比的二进制序列, 且二进制数值往往用脉冲表示, 从而用脉冲对采样幅度进行编码, 故称**脉冲编码调制**. 
由于这种方式完全不考虑语音的特殊性质, 故信号并没有得到实际压缩. 
#TODO 第一章的式 (1-16) 给出了信号均匀量化的信噪比公式, 该式可近似写成 $\text{SNR}(dB)\approx 6\text{B}-7.2$, 式中 $B$ 为量化器字长. 
因此, 信噪比取决于量化字长. 
当要求 60dB 的 SNR 时, $B$ 至少取 11.
此时, 对于带宽为 4kHz 的电话语音质量, 若采样率为 8kHz, 则 PCM 要求的速率为 88kbit/s 才能满足所要求的语音质量. 
这样高的比特率是无法承受的, 因而必须采用具有更高性能的编码方法. 

均匀量化的一个缺点是: 在信号动态范围较大而方差较小时, 其信噪比将下降, 这可从式 (1-16) 看出. #TODO

第一章曾指出: 语音信号值大部分集中在低幅度上, 因此可利用非均匀量化, 使低电平区的量化阶距最稠密.

**非均匀量化**的基本思想是对大幅度的样本采用大的量化阶距 $\Delta$, 对小幅度的样本使用小的 $\Delta$. 
它首先将语音信号的幅度进行非线性的对数变换压缩, 然后对压缩后的信号作 PCM, 常称为对数 PCM. 
在译码时, 需要按指数进行扩展. 
这种技术也就是第一章中曾提到的压扩技术. 

国际上的压扩标准有两个: A 律和 $\mu$ 律. 
美国采用 7 位的 $\mu$ 律 PCM 为长途电话质量标准. 
我国则采用 A 律标准. 目前已存在标准的 A 律 PCM 编码芯片. 

PCM 在量化间隔的选取上存在矛盾: 为适应大的幅值要用大的 $\Delta$, 但为提高信噪比又希望用小的 $\Delta$. 
除非均匀量化外, 人们还可采用**自适应 PCM 方法 (APCM)** 来解决该矛盾. 
它使量化器的特性自适应于输入信号的幅值变化, 也就是 $\Delta$ 匹配于输入信号的方差值, 或量化器的增益 $G$ 随着幅值的变化而变化从而使量化前信号的能量为恒定值. 
自适应方法包括前向自适应和后向自适应两种, 有关自适应思想可参见2.5节. #TODO 
实验表明, 采用自适应技术, 可使编码增益提高 4~6 dB.

#### 2.2.2.基于预测的语音编码

根据前面的叙述可知, 利用线性预测可改进编码的量化器性能.
因为预测误差 $e(n)$ 的动态范围和平均能量均比原输入信号 $x(n)$ 低, 若对 $e(n)$ 进行量化和编码, 则所需的比特数将减少. 
在接收端, 只要使用与发送端相同的预测器, 就可恢复信号 $x(n)$. 
基于这种原理的编码方式称为**预测编码 (Predictive Coding, PC)**; 
当预测系数自适应地随语音信号变化时, 又称为**自适应预测编码 (adaptive PC, APC)**. 
有关预测的思想可參见第一章和第二章, 那里已经解释了预测编码能够改善信噪比的原因. #TODO

仿真实验表明, 
基于固定预测时, 预测增益约为 10dB. 
而基于自适应预测时, 预测增益约为 14dB. 

#### 2.2.3.基于 ADPCM 和 ADM 的语音编码

由于相邻的语音样本之间存在明显的相关性, 故对相邻样本间的差值信号 (差分) 进行编码可得到信号压缩, 因为差分信号比原始信号的动态范围和平均能量都小. 
这种编码就是在第一章曾提到过的**差分编码调制 (DPCM)**, 它实质上是一种一阶 APC, 是最简单的一阶线性预测, 即 $A(z)=1-a_1 z^{-1}$, 当 $a_1=1$, 被量化的信号就是 $e(n) =z(n)-z(n-1)$.

由于 $a_1$ 是固定的, 显然它不能对所有讲话人和所有语音内容都是最佳的. 
如果采用高阶的固定预测, 改善效果并不明显. 

为此, 可采用高阶自适应预测. 
采用自适应量化及高阶自适应预测的 DPCM 称为 **ADPCM**, 它本质上也是一种APC. 
实践表明, DPCM 可获得约 10dB 的信噪比增益, 而 ADPCM 可获得约 14dB 信噪比增益. 

#TODO fig 图 7-6 是在 ADPCM 基础上加上基音预测器的量化编码系统, 称为 APPDPCM. 
图中 $P_A (z)$ 为线性预测器, $P_S(z)$ 是基音周期预测器增量调制 (DM) 是一种特殊简化的 DPCM, 是一种极限情况, 即 1 比特量化器. 
对于相关信号, 随着取样率的提高, 邻近样本间的相关性变强, 预测误差减少. 
由于预测增益很高, 故允许粗糙的量化. 
它的最大特点是简单, 易于实现. 其缺点是存在斜率过载失真. 
DM 原理已在第一章中作详细介绍, 这里不再详述. #TODO
在 DM 中, 对于电话频带的语音波形, 为确保高质量, 取样率要求在 200kHz 以上. 
同时, 由于使用固定阶距 $\Delta$ , 不能适应信号的变化, 故大约只能得到 6dB 的增益. 

为减少斜率过载失真, 必须把 $\Delta$ 设计得大一些; 但是 $\Delta$ 过大, 则又增加粒状噪声. 
因此, 兼顾这两方面的要求, 需要按均方量化误差最小 (即使两种失真减至最小) 的准则来选择 $\Delta$. 即采用随输入波形自适应改变 $\Delta$ 的自适应编码方式, 使 $\Delta$ 值随信号的平均斜率的变化而变化: 斜率大时,  $\Delta$ 自动增大; 反之则自动减少. 这就是**自适应增景调制 (ADM)**. 

引入自适应技术后, ADM 大约可增多 10dB 的增益. 
实验表明, 取样率为 56kHz 时 ADM 具有与取样率为 8kHz 时的 7 比特对数PCM相同的语音质量.


常用的一种 ADM 为**连续可变斜率增量调制 (Continuously Variable Slop Delta Modulation, CVSD)**, 其自适应规则如下: 

$$
    \Delta(n)=\begin{cases} k\Delta (n-1) + P, & e(n)=e(n-1)=e(n-2)\\ k\Delta (n-1) + Q, & else\end{cases}
$$

式中, $0<k<1$, $P>Q$, $P$ 是能使系统对斜率过载作出响应的一个较大的常数. 

CVSD 的基本原理是按照码字序列中的斜率过载情况来改变 $\Delta(n)$. 
假定相邻的三个码字为全 1 或全 0, 则 $\Delta(n)$ 增加一个值; 否则, $\Delta(n)$ 一直递减到由 $k$ 和 $Q$ 共同决定的 $\Delta_{\min}$. 
参数 $k$ 控制自适应速度: 若 $k$ 接近于 $1$, 则 $\Delta(n)$ 增加或减少的速度变慢; 若 $k$ 很小, 则自适应速度加快. 

#### 2.2.4.子带编码 SBC

上述各种编码方法均是时域编码方法, 这一部分和下一部分介绍的是变换域编码方法. 
子带编码也称频带分割编码, 它首先使用带通滤波器组将语音信号分割成若干个频段 (也称为子带), 然后用调制的方法对滤波后的信号即子带信号进行频谱平移变成低通信号 (即基带信号), 以利于降低取样率进行抽取; 
再利用奈奎斯特速率对其进行取样, 最后再进行编码处理. 
而信号的恢复则与上述过程完全相反.
SBC 的优点是它利用人类的听觉特性, 比较容易抑制噪声. 
各子带可选用不同的量化参数以分别控制其信噪比, 满足主观听觉要求. 

#### 2.2.5.自适应变换编码 ATC

自适应变换编码与 SBC 一样, 它也是在频域上分割信号, 但比 SBC 增加了相当大的自由度. 
这种方法是对信号进行正交变换以降低信号相邻采样间的冗余度. 
它首先把语音数据串分成一系列帧, 对每帧进行正交变换, 然后对变换系数进行编码和传输. 
在接收端由反变换来恢复语音. 
ATC 系统通常选用 DCT 变换, 对每一帧作 DCT 变换后, 把 DCT 系数分成 20 个左右的频带, 求各频带的平均功率, 作为边带信息传送. 
这样, 编码器输出的信号为表示频谱包络的辅助信息以及被量化过的 DCT 系数. 
传送边带信息需要 2kbit/s 的速率. 
在非自适应情况下, 比特分配和量化间隔均根据语音信号长时间统计特性来确定, 它们是固定不变的. 
而在自适应情况下, 需要估计毎帧变换谱的包络, 使用估计的谱值代瞽方差, 再求出比特分配方案. 
表征估计谱的参数作为边带信息传送到接收端, 接收端使用与发送端相同的步骤求出比特分配方案, 以便对变换域参数进行解码. 
这样一来, 人们就能最恰当地分配各 DCT 系数的量化比特数, 同时自适应控制量化电平. 
但是, 估计谱要作为边带信息传送, 它所占的比特数要受到限制, 可见边带信息的提取和处理也是 ATC 的重要问题之一. 
这里, 谱估计可采用线性预测分析, 也可使用线性预测滤波器组的方法. 
据报道, 与对数 PCM 相比, ATC 可在 16~32kbit/s 的范围内, SNR 可得到 17~23dB 的改善. 

#### 2.2.6.基于矢量量化的语音波形编码

利用矢量量化进行语音波形编码的基本原理是: 将语音信号波形分割成一系列含k个样点的矢量, 然后对每个k维矢量进行矢量量化. 在第二章的各种无记忆矢量量化器的仿真实验中, 曾多次采用谱音波形编码作为例子说明各种矢量量化器的性能. 在此不再作详细说明. 下面要给出的是基于自适应预测矢量量化的语音波形编码原理. 根据第二章的描述可知, 有记忆矢量量化在量化每一个输入矢量时, 不仅与此矢量本身有关, 而且也与其前面的矢量有关. 也就是在量化时, 它通过“记忆”, 利用过去输入矢量的信息以及矢量与矢量之间的相关性, 来提高矢量量化性能. 有记忆矢量量化通常可分为反馈矢量量化和自适应矢量量化两类. 反馈矢最量化主要有预测矢量量化和有限状态矢量量化两大类. 而自适应矢量量化则采用多个码书, 量化时根据输入矢量的不同特征采用不同码书. 编码器需要传送一些速率很低的附加信息, 通知译码器使用哪个码书. 自适应矢量量化经常可用于其他矢量量化系统中, 其中典型的例子就是自适应预测矢量量化器 (APVQ) . APVQ实际上是PVQ和AVQ的结合. 从语音波形编码的观点来看, 它就是ADPCM的矢量推广. 该系统的原理框图如图7-7所示. 在输入端, 将输入语音信号序列分帧, 构成矢量序列, 对某一输入矢量ェ, 用线性预测方法产生一个预测矢量x, 相减后得到误差矢量e.-x.-名, 将误差矢量

e. 进行矢摄量化, 得到e. 的量化矢量4n, 并将该重构误差码字的索引送給信道. 另
一方面, 这里还采用自适应技术, 即: 根据谱音流各段不同的统计特性, 将输入矢量划分为不同类型, 然后确定使用多个码书和预测器对中的哪一对, 由顿分类器输出边带信息, 决定用哪一个码书进行误差矢量的量化和用哪一个预测器来得到预测矢量. 同时这个信息也由信道送到接收蝓. 在译码端, 根据接收到的边带信息确定使用接收端的哪一对码书与预测器; 再由接收的误差码字索引在码书中找到量化矢量e. 由于APVQ 使用自适应和线性预测技术, 故它既去掉矢量与矢量之间的编码冗余度, 又利用语音信号的局部特性. 尽管复杂度比普通的矢量量化系统高, 但实践表明, 该系统用于语音编码时, 其信噪比可比一般的穷尽搜索矢量量化器提高7dB以上. 因此, APVQ 是一种比较优良的数据压缩方案. 除APVQ外, 人们还可将有限状态矢量量化 (FSVQ) 用于谱音的波形编码. 表7-1给出FSVQ, APVQ和基本 VQ编码器的性能比较, 表中的性能指标为信噪比. 由表可见, FSVQ 的性能比APVQ编码器好一些, 而比基本VQ的性能好得多. 

### 2.3.语音信号的参数编码

#### 2.3.1.相位声码器和通道声码器

相位声码器和通道声码器都是基于短时傅里叶变换的语音 "分析-合成" 系统.
它们利用滤波器组把语音的频率成分划分为一组相邻的频带, 然后传输各频带中的语音成分.
其差别在于这些频带或通道内的编码保真度不同.

相位声码器有点类似于前面曾介绍过的子带编码, 输入语音首先由带通滤波器组产生子带信号, 然后再分别对各子带信号进行量化和编码. 不同的是相位声码器中通道数一般很大, 大约每隔100Hz一个, 因此每个通道内只有一个谐波成分. 另外, 它不像子带编码那样使用APC方法对子带信号进行编码, 而是对通带内的幅度和相位导数进行编码, 如图7-8所示. 假设采用L个通道, 适当选择各通道滤波器的中心频率和分析窗以覆盖所要求的频带, 那么对各通道的输出求和可获得合成信号

式中, ャ=|p|ei#) 为复常数, 应选择使全部通道的总响应尽可能平坦的幅度响应和线性相位特性. 分析窗wh (n) 相应于低通滤波器的冲激响应. X. (e) 可用比输入小得多的取样率. 为使系统能够实用, 需要作进一步简化, 令 X,  (e) =|X.  (em) |e规i%) =a (w) -jb.  (w) 
 (7-65) 则有
Xn (e*) |=[a (w) 十昭 (w) ]]/2
 (7-66) 0_ (w) =-tg'[bo (w6) /a,  (w) ]
 (7-67) 其次, 使用相位导数0. (a) +
8. (w) -b. (w) @,  (@) -a. (w) b,  (w) af (w) 十b (w) 
 (7-68) 它是第k个通道输出相对于中心频率w的瞬时频率偏移. 这里, 采用相位导数而不是相位本身的主要原因在于: 当声道和音调都缨慢变化时, X,  (e*) 的幅度和相位也都在缓慢变化. 相位值是无界的, 它不适宜于量化; 而相位导数是频率偏移, 是有界的. 另外, 由于相位声码器中通道数很大, 其基音周期在一帧内几乎是一个常

数, 故只有一个谐波落在一个通道的频带内. |Xn<e*) |反映了声道在叫频率上绶慢变化的幅度响应, 而相位导数是该通道内谐波分量对中心频率a的偏离, 它接近常数. 因此, 相位声码鬏只需很少的比特数来量化这两个多数, 从而使传输码速率得以降低
最简单最古老的语音编码装置是通道声码器, 这种声码器是广泛应用的早期声码器形式. 发送端对输入语音进行粗略的频谱分析, 而在接收端产生一个信号以使频谱与发送端规定的频谱相匹配. 通道声码器与相位声码器类似, 但更简单. 它仅传输各通道谱幅的均值和基音周期值, 而不传输相位导教. 这虽然损失了谐波之间的相位关系, 但由此可大大降低传输码率. 另一方面, 由于它在分析和综合系统中引入较多的语音模型特性, 且增加了基音检测器, 从而增加了声码器复杂度. 在发送端, 语音加在滤波器组和基音提取器上. 滤波器组将谮音的频率范围分为许多相邻的频带或通道, 黹波器组的数目取决于不同的结构方式, 一般为14个到20个以上, 而覆盖的颍率范围通常为电话带宽, 从300Hz或 300Hz以下到大约
3.3kHz. 任何一个滤波器的输出都是一个能反映该滤波器频带功率瞬时变化的包络. 因此, 整个滤波器输出的包络近似于语音的濒谱包络. 因为这种包络的变化比语音波形本身慢得多, 所以它可用很低的速率采样. 因此, 滤波器输出通常利用全波整流器和低通溏波器进行包络检波, 采样速率一般为每秒50个样本. 带通滤披器的单位样值响应为w (n) cos (wn) , 每个通道输出为|X. (e) |的平均值, 如图7-9
所示. 为利用人耳在低频段的较好的分辨特性, 各通道的带宽并非均匀, 大约在100~400Hz. 低通滤波器的带宽由取样率决定. 通过边带信息, 包括浊音/清音分类, 基音周期等, 来恢复语音信号的谐波结构, 或者说是提供声门激励的信息. 通道声码器的主要缺点是需要检测基音周期和进行清/浊音判断. 精确地提取基音周期相当困难, 基音估计的误差对合成语音的质量影响很大, 这是通道声码器系统本身的弱点. 其次, 由于通道数目有限, 可能几个谐波分量落入同一通道, 在合成时它们
将被赋予相同的幅度, 结果导致频谱畸变. 

#### 2.3.2.同态声码器

同态声码器的基础是语音信号的产生模型, 即语音信号由声门激励和声道响应序列的卷积产生, 因此可采用同态解卷方法来进行处理. 依赖于时间的同态处理将基本的语音信号参数清晰地表现出来并且将它们互相分开, 即激励信息处于倒谱的高时域而声道信息处于低时域. 同态声码器的原理框图如图7-10所示. 在同态声码器中, 每10~20ms计算一次倒谱, 从每一帧的倒谱高时部分估计基音周期和浊/清音信息; 它们和倒谱的低时部分一起, 经过量化和编码后进行存储或传输. 在接收端合成部分, , 接收到的声门激励多数生成声门激励序列; 从量化的低时段倒谱计算出近似的声道冲澈响应, 令两者直接卷积就得到合成的语音信号. 若同态滤波器用26个倒谱值, 每个值用6比特量化, 再加上与声门激励有关的边带信息, 在帧取样率 50 次/s的情况下, 可产生高质量的自然语音. 研究表明, 若在量化前的倒谱值上作某些处理, 例如只传输差分值, 则可进一步压缩码速率. 另外, 求声门激励和声道模型参数时, 使用不同长度的时窗, 以及使窗长自适应于语音波形特征也将使编码效率得到提高. 事实上, 如果使用真正的倒谱 (指保留相位信息) 即复倒谱, 同态声码器输出的语音质量还将进一步得到改善. 从图7-10可以看出, 同态声码器的运算量较大, 发送端和接收端都需要作二次DFT. 这种声码器具有一个优点, 就是占去大部分计算量的倒谱既可用来估计激励叁数, 又可用来估计声道参数. 如果已经具有一个计算DFT的设备, 这种方案是很有吸引力的. 

#### 2.3.3.线性预测声码器

迄今, 线性预测声码器仍然是最成功和应用最广泛的声码器, 其典型的原理框图如图7-11所示. 与线性预测波形编码不同的是, 它不对残差进行量化编码, 而是对 LPC 参数进行变换和量化. 接收端直接合成语音, 而不具体恢复输入语音的波形. 这样得到的语音具有明显的人工语育特点. LPC 在波形编码中的主要作用是用作预测器, 而在声码器中的主要作用是建立模型. 在LPC 声码器中, 必须传输的参数是p个预测器参数, 基音周期, 清浊音信息和增益参数. 直接对预测器系数量化后再传输是不合适的, 因为系数的很小变化都将导致合成滤波器的极点位置有较大变化, 甚至造成不稳定现象. 这表明需要用较多比特数去量化每个预测器系数. 为此, 可将预测器系数变换成其他更适合于编码和传输的参数形式. 归纳起来, 有如下三种: 反射系数, 对数面积比和预测多项式的根. 通常, 一帧典型的LPC数据包括1比特清浊音信息, 大约5比特增益常数, 6比特基音周期, 平均5~6比特来量化每个反射系数或对数面积比, 所以每帧约需60比特. 若一帧占25ms, 则声码器的码速率为2.4kbit/s左右. 

#### 2.3.4.多脉冲激励线性预测编码

数字语音通信的基本矛盾是语音质量与传输码速率之间的矛盾. 前面曾提到的各种传统波形编码技术, 在传输码速率为32~64kbit/s时可获得优等的语音质量. 但一旦传输码速率下降到9.6kbit/s以下, 语音质量急剧下降. 而前面提到的几种声码器, 虽然其传输码速率可降至2.4kbit/s左右, 但其语音质量为中下水平, 即使提高码速率, 语音质量也难以提高. 当前数字语音通信的发展方向有两个: 一个是在9.6kbit/s左右中等传输码速率条件下, 设法得到优等的语音质量; 另一个是在极低传输码率 (200bit/s以下) 条件下, 设法得到中等以上的语音质最. 研究表明, 声码器谱音质量差的问题不在于声道模型参数, 而在于激励信号. 多年来一直广泛使用的把准周期脉冲白噪声作为激励源的方法是提高语音质量的障碍. 为此, 近年来出现新一代的声码器, 在保留现有声码器技术上, 它引用高质量的波形编码准则来优化激励信号, 通常采用混合编码技术. 目前较为成功的混合编码方案有: 多脉冲线性预测编码 (MPC) 和码激励线性预测编码 (CELPC) . 前者使用一个数目有限, 幅度和位置可调整的脉冲序列作为激励源; 后者则使用一个波形码字作为激励源, 它通常从由高斯白噪声序列构成的码书中选取. 这一部分主要介绍前者, 由于后者属于矢量量化技术的一种应用, 故将在下一部分作介绍. 多脉冲激励线性预测编码的原理框图如图7-12所示. Atal 等人最先提出多脉冲激励模型线性预测声码器的原理和算法. 这里, 无论是有声还是无声, 无论是合成清音还是油音, 激励信号都呈现多脉冲形式. 该方法的关键是如何最佳地确定激励序列中各脉冲的幅度和时间位置. 实际上, 它们是根据原始语音和合成语音之间的听觉加权均方误差最小原则逐个加以确定的[353], 其原理如图7-13所示. 

#### 2.3.5.基于矢量量化的语音信号参数编码

对语音波形的压缩编码, 过去大多采用标量量化方法. 但是, 为达到较高的语音质录, 通常箫要很高的传输码速率. 因此, 人们可用矢量量化进行谱音波形编码. 另一方面, 人们可对语音信号进行分析, 得到各种参数, 然后再将这些按帧或按段分析所得到的参数组构成矢量, 进行矢量量化. 这种方法称为语音信号的参数矢量量化. 由于线性预测参数是目前最常用的一种参数 (它在语音质量和运算量之间折衷考虑) , 故它的矢量量化是人们最关心的问题. 这里将介绍矢量量化在声码器中的两种典型应用, 一种是用于线性預测编码的矢量量化器, 简称为VQ-LPC 声码器; 另一种是码激励线性预测编码声码器, 简称CELPC 声码器假设已存在一个2.4bit/s的十阶线性预测声码器, 则相应的 800bit/s的VQ-LPC声码器[18]原理如图7-14所示. 在不用矢量量化的线性预测声码器中, 采样速率为44.4帧/s, 用54比特量化 (其中, 10个线性预测系数用41比特, 基音罔期用6比特, 增益参数用5比特, 清/独音判决用1比特, 同步用1比特) . 而在VQ-LPC声码器中, 线性预测系数为{A}, 基音周期是{B}, 増益参数为{G}和浊/清音识别
参数为{V}. 它的主要特点是对线性预测系数采用矢量量化, 而其余参数均采用差值标量量化. 这样, VQ-LPC声码器的编码速率明显比原来的LPC声码器低. 比特分配对 VQ-LPC声码器来说是非常重要的, 显然它的帧速率仍为44.4帧/s, 但是它用54比特对三帧LPC爹数统一进行编码 (平均每帧为18比特) , 即每三个连续帧为一组矢量, 只对该组线性预测系数进行矢量量化. 具体分配如下: 线性预测系数的编码用30比特 (平均每帧10比特) ; 基音周期和浊/清音判别用12比特; 增益参数用 11比特; 同步用1比特. VQ-LPC声码器采用与能量和增益无关的对数似然比失真测度作为VQ的距离测度. 码书尺寸为1024, 即用10比特来表示码字索引. 码书的产生用10个人 (7男3女) 的大约30分钟的随机对话的声音来进行训练产生, 并将训练序列分为浊音和清音两类. 因此, 对应的码书也分为浊音码书和清音码书两类, 都用GLA 算法训练. 通常, 在码书大小相同的条件下, 清音码书比独音码书具有更低失真. 所以, 在失真相同的条件下, 清音码书的尺寸可选择小一些, 
码激励线性预测编码声码器[200]是一种新一代的声码器, 它用最佳码字作为激励信号, 从而可使线性预测声码器在8kbit/s传输码速率时具有较高的语音质量, 并且有可能使码速率下降到 4.8kbit/s. 这使得用无线电窄带信道和用电话线实现点对点的数字通信成为可能. 这种方法的工作原理曾在第二章中介绍过, 可参考图2-58加以理解. 由于频谱包络信息从比较短的谱音帧中求出, 而音调信息从比较长的语音帧中求出, 故称前者为短时延相关滤波, 而后者为长时延相关滤波. 图中每帧所需的激励序列选自某个固定码书中的一个波形样本码字, 当用这个码字去激励合成滤波器时, 产生的合成语音和原始语音间的感知误差最小. 这种声码器称为激励声码器. 产生码书的一种方法是用VQ从大量线性预测残差序列中用聚类的方法产生, 但运算量太大, 因为在确定码字时, 还必须计算每个预测残差序列所产生的合成语音. 另一种方法是用高斯白噪声序列随机生成, 其依据是谱音信号经线性预测 (包括长时预测) 后的残差信号接近高斯分布. 后一种方法又称为随机激励编码器, 其优点是码宇可在发送端和接收端同步随机产生, 从而节省大量存储空间. 码书索引确定后, 编码操作就是在码书中寻找最优激励矢量, 其过程与MPC方法完全类似. 

## 3.矢量量化在语音识别中的应用

语音识别是研究使机器能准确地听出人语音内容的问题, 即准确地识别所说的话. 语音识别是近二三十年发展起来的新兴学科, 在计算机, 信息处理, 通信与电子系统, 自动控制等领域中, 在工业, 军事, 交通, 医学, 民用诸方面有者广泛应用. 语音识别按不同角度有下面几种分类方法:  (1) 从所要识别的单位来分. 分为孤立词识别, 音素识别, 音书识别, 孤立句识别及连续语音识别和理解等.  (2) 从识别的词汇量来分. 分为小词汇 (10~50) , 中词汇 (50~200) , 大词汇 (200以上) 等孤立词识别. 在所有情况下, 语音识别的识别率都随单词量的增加而下降.  (3) 以讲话人的范围来分. 分为单个特定讲话人, 多讲话人 (即有限个讲话人) 和与讲话人无关的
 (即无限个说话人) 三种语音识别.  (4) 从识别的方法分. 有模板匹配法, 随机模型法和概率语法分析法. 这三种方法都基于统计模式识别方法. 其识别过程大致如下: 首先判定语音的特征作为识别参数的模板; 然后用一个可衡量未知模式和参考棋式 (即模板) 间似然度的测度函数; 最后选用一种最佳准则及专家知识作为识别决策, 对待识别者作最后判决, 得到最好的识别结果作为输出. 除上面三种方法外, 其他识别方法还包括人工神经网络语音识别, 应用模型数学的语音识别及句法语音识别等, 
进入20世纪90年代以后, 语音识别的研究重点已转移到大词汇量, 非特定人, 连续语音上来, 且已取得一些突破. 典型做法是: 以HMM为统一框架, 构筑识别系统棋型. 每个基本识别单元至少建立一套HMM 结构和参数. 大词汇量, 非特定人的连续识别系统可用于人机直接对话, 语音打字机以及两种语言之间的直接通信等一系列重要场合. 

### 3.1.语音识别原理

语音识别的步骤分两步. 第一步是根据识别系统的类型选择能够满足要求的种识别方法, 采用语音分析方法分析出这种识别方法所要求的语音特征参数, 并把这些参数作为标准模式存储在机器中, 形成标准模式库, 这个语音多数库称为
“模板”, 这一过程称为“学习”或“训练”. 第二步就是识别. 语音识别的原理如图7-15所示. 图中, 预处理包括抗混叠滤波, 模/数转换, 自动增益控制, 去除声门撇励及口屑辐射的影响, 还包括在声学参数分析之前正确选择识别基元的问题. 经过預处理的语音信号, 需要对其进行特征参数分析. 参数可选择下面的一种或几种: 平均能量, 过零数, 频谱, 共振蜂, 倒谱, 线性预测参数, 偏自相关系数, 声道形状的尺寸函数, 随机模型的概率函数, VQ矢量以及音长, 音调, 声调等超音段信息雨数. 一般情况下, 参数中包含的信息越多, 分析和提取的复杂度也越大, 但是正确识别率也相应地增加. 用于语音识别的距离测度很多, 如欧氏距离及其加权瞅氏距离, 
似然比洲度, 加权超音段信息的识别测度等等. 此外, 还可用HMM 之间的距离测度, 主观感知的距离测度等. 语音库是指声学参数模板. 它是用训练与聚类的方法, 从单讲话者或多讲话者的多次重复的语音参数, 经过长时间的训练而聚类得到. 浏度估计是语普识别的核心. 目前, 学者们已研究过多种求取待测试语音拳数与模板间渊度的方法, 如DTW法, VQ法, HMM法, VQ/DTW法以及FSVQ/HMM法等等. 专家知识库用来存储各种语言学知识, 如汉语声调变调规则, 音长分布规则, 同音字判别规则, 构词规则, 语法规则, 语义规则等. 对不同语言应采用不同的语言学专家知识库. 判决过程就是: 对于输入信号计算得到的测度, 根据若干准则及专家知识, 判决选出可能结果中最好的结果, 由识别系统输出. 在语音识别中, 一般都采用K平均最近邻 (K-NN) 准则来进行决策. 因此, 选择适当的各种距离测度的门限值成为主要问题. 判决的结果一一-识别率是检验门限值选择正确与否的惟一标准; 往往需要调整这些门限值才能得到满意的识别结果. 图中, 测度估计, 判决和专家知识库三部分的功能是完成模式匹配. 

上面所述的语音识别原理框图是针对统计模式识别而言. 除此之外, 还有句法模式识别法. 图 7-16为句法模式识别系统的原理框图. 首先, 对语音信号进行结构分析, 由阶层式的分模式构成模型, 即对象模式. 输入语音信号经预处理后, 对此信号作模式描述, 然后对此模式作模式分析, 检査输入模式与识别对象的棋式结构是否相同或在某范围内结构一致, 由此判定输入模式就是某种对象模式, 从而得到识别结果. 

在语音识别中, 最重要的两种识别系统是孤立词识别系统和连续语音识别系统. 其中, 人们对孤立词的识别, 研究最早也最成熟, 因为这种系统存在的问题最少, 即: 单词之间没有停顿; 单词之间的端点检测比较容易; 单词之间的协同发音影响也可减至最低. 孤立词语音识别的方法大致有以下几种: 
 (1) 采用动态规划技术. 这种方祛运算量较大, 但是技术上比较简单, 识别正确率也较高. 其中失真测度可用欧氏距离 (适用于短时谱或倒谱参数) 或对数似然比距离 (适用于 LPC参数) . 决策方法可用最近邻域准则. 
 (2) 采用矢量量化技术. VQ最早用于语音的波形编码和参数编码中, 近几年
オ被用于语音识别中. 尤其在孤立单词识别系统中, VQ技术得到很好的应用. 特别是有限状态矢量量化技术对语音识别更有效. 决策方法一般用最小平均失真准则, 
 (3) 采用隐马尔可夫模型 (HMM) 技术. 该模型参数既可用离散概率分布函数, 也可用新发现的连缕概率密度丽数 (如正态高斯密度, 高斯自回归密度等) . 决策方法则用最大后验概率准则. 该技术可用于孤立词识别, 连续语音识别以及讲话人确认系统中. 
 (4) 采用混合技术. 如用矢量量化作为第一级识别 (作为预处理, 从而得到若干侯选的识别结果) , 然后用 DTW或HMM 方法作最后识别, 即VQ/DTW和VQ/HMM方法. 
图7-17给出孤立词识别系统框图. 图中语声学分析部分的作用是抽取语音特征信息. 这些信息一般用矢量量化技术进行压军处理. 模式识别部分将压缩后的语音信息与参考模式进行比较, 其中参考模式中存储着训练时得到的压缩过的语音特征参数. 根据参考模式是模板还是随机模型, 分别采用DTW和HMM 方法进行时间规整. 后处理器主要是运用语言学知识对识别出的侯选字或词进行最后的判决. 

上述的孤立词识别过程基本上是建立在数学方法基础之上, 是不含“语言”知
识的识别. 尽管这些技术在很大程度上可推广到连续语音识别中, 但连续语音识别比孤立词语音识别困难得多, 在连续语音识别中存在很多特殊问题. 首先遇到的问题就是切分问题, 因为语言中的短语数量太大, 必须将输入的语流切分为更小的组成部分. 因为连续语音中间没有间歇, 在识别前必须先把各字分开, 即必须识别单词之间的边界, 这个问题通常很难, 目前还没有现成方法. 其次, 连续语音的发音比孤立词发音更随意, 受协同发音的影响也更严重, 其中短单词所受的影响最大, 而且英语中还有连读现象. 训练时所遇到的主要向题是训练时间和用户配合程度. 目
前, 对连续语音的识别除用DTW, HMM 和VQ外, 最热门的是用人工神经网络识别法和模糊数学识别法. 连续语音识别的很多问题均与语言学知识有关, 特别是在大词汇量的识别系统中需要更多地强调语言学知识的运用. 图7-18给出基于知识库的连续语音识别方案. 

### 3.2.基于动态时间规整的语音识别

端点检测是语音识别的一个关键步骤, 它是特征训练和识别的基础. 端点检测是指找出语音信号中的各种段落 (如音素, 音节, 词素和词等) 的起点和终点位置从语音信号中排除无声段. 端点检测的精度高低直接影响识别率. 端点检测通常采用时域分析法, 进行端点检测的主要依据是能量, 振幅和过零率. 但是, 某些单词的端点检测却存在问题. 如单词最后的声音带上一些拖音或呼吸音时, 容易将拖音或呼吸音误认为是一个音位而造成错误. 另外, 在噪声环境下, 准确检测声音区间是很困难的, 
在语音识别中, 不能简单地将输入参数和相应的参考棋板直接作比较, 因为语音信号具有相当大的随机性, 即使是同一个人在不同时刻说的一句话, 发的同一个音, 也不可能具有完全相同的时间长度. 在进行模板匹配时, 这些变化会影响测度的估计, 从而使识别率降低. 为此, 一种简单的方法就是采用对未知语音信号均匀地伸长或缩短直至它与参考模板的长度一致. 采用这种方法能达到的精度完全取决于端点检测的精度. 因此, 这种仅仅利用压扩时间轴的方法不足以实现精准的对正. 研究表明, 这种简单方法在大部分识别系统中不能有效地提高识别率. 语音识别的研究取得实质性进展的重要标志就是60年代中期日本学者Itakura将动态规划算法用于解决语音识别中语速多变的难题, 提出著名的动态时间规整算法[s4] (DTW, Dynamic Time Warping) , 为解决这一问题提供一条有效途径. 当词汇表较小, 各词条不易混淆时, DTW取得很大成功. 在这种方法中, 未知单词的时间轴要不均匀地扭曲或弯折, 以便使其特征与模板特征对正. 用DTW技术实现时间规整是一种非常有力的措施, 对提高系统识别精度非常有效. 由于该方怯对语音识别产生重大影响, 故它已成为语音识别中不可缺少的技术之一. 在规整过程中, 输入的是两个时间函数, 典型的是幅度, 共振峰或LPC系数. 如图7-19所示, 设A, B为要进行匹配的时间函数, B为模板, A为被测语音, 把它们画在两个坐标轴上, 对角曲线表示它们之间的映射关系. 动态时间规整是将时间规整和距离测度结合起来的一种非线性规整技术. 若设测试语音参数共有N帧矢量, 而参考模板共有M帧矢量, 且N#M, 则动态时间规整就是寻找一个时间规整雨数j= w (i) , 它将测试矢量的时间轴i非线性地映射到模板的时间轴j上, 并使该函数w满足

式中, d[T (i) , R (w (i) ) ]是第i帧测试矢量T (i) 和第j帧棋板矢量R (j) 之间的距离测度, D则是处于最优时间规整情况下两个矢量之间的匹配失真, 这就保证了它们之间存在最大的声学相似特性. 在实际操作中, DTW采用动态规划技术 (dy-namic programming, DP) 来具体实现. 动态规划是一种最优化算法, 其原理如图7-20所示. 通常, 规整函数w (i) 限制在一个平行四边形内, 一条边的斜率为2, 另一条边的斜率为1/2. 规整函数的起始点为 (1, 1) , 终止点为 (N, M) . w (i) 的斜率

为0, 1或2. 这是一种简单的路径限制. 人们的目的是寻找一个规韭函数, 在平行四边形内使点 (1, 1) 到点 (N, M) 具有最小代价函数. 由于已对路径进行限制. 故计算量可相应地减少. 总代价函数计算式为
D[c (k) ]=d[c (k) ]十 minD[c (k-1) ]
 (7-70) 式中, d[c (k) ]为匹配点c (k) 本身的代价, minD[c (k-1) ]是在c (h) 以前所有允许值 (由路径限制而定) 中最小的一个. 因此, 总代价函数是该点本身的代价与达到该点的最佳路径的代价之和. 通常动态规划算法是从过程的最后阶段开始, 即最优决策是逆序的决策过程. 进行时间规鰲时, 对于每一个i值都要考虑沿纵轴方向可达到当前值的所有可能的点, 而得到几种可能的先前点, 对于每一个新的可能点按式
 (7-70) 找出最佳先前点, 得到此点的代价. 随着过程的进行, 路径要分叉, 并且分叉的可能性也不断增大. 不断重复这一过程, 可得到从 (N, M) 到 (1, 1) 点的最佳路径, 
从上面的描述可以看出, 动态规划存在下列问题:  (1) 运算量大. 由于要找出最佳匹配点, 故要考虑多种可能的情况. 虽然路径限制减少了运算量, 但运算量仍然很大, 因而使识别速度减慢. 这在大词汇量的识别中是一个严重缺点.  (2) 识别性能过分依赖于端点检测. 端点检测的精度随着不同音素而有所不同, 有些音索的端点检测精度较低, 由此影响识别率的提高.  (3) 没有充分利用语音信号的时序动态信息. 现已提出多种方法来克服这一缺点. 例如文献[355]中提出了遗传时间规整方案GTW, 其目的是找到最佳的时间规整路径, 该方法取得了很好的识别效果. 尽管如此, DP仍然是一种有效的时间规整和语音测度计算的方法, 在孤立学识别中有广泛应用. 

### 3.3.基于矢量量化的语音识别

VQ最早用于语音的波形编码和参数编码中, 近几年才用于语音识别中. 尤其在孤立单词识别系统中, VQ 技术得到了很好的应用. 特别是有限状态矢量量化技术. 对语音识别更有效. 除此之外, 矢量量化技术还可与其他技术相结合, 如在VQ/HMM 语音识别系统[3561中, VQ作为整个识别系统的一个前处理器. 下面分别介绍这两种识别系统, 
前面曾提到, FSVQ可用于谱音编码. 在FSVQ谱音编码器中, 状态转移函数用来决定下一个输入信号矢量应与系统中哪一个码书的所有码字进行匹配. 而在FSVQ语音识别器中, 设单词库中有V个单词, 由于为每一个单词都建立了一个码书, 故系统应具有V个状态转移丽数, 即每个单词都有一个状态转移函数. 每个转移函数袂定输入信号矢量应与码书中的哪一个码字进行匹配. 也就是说, 现在的状态是指码书内部的码字状态. 设输入的某单词包含N个 (帧) 矢量, 则它们与每个码书中的码字都要进行N次匹配. 最后, 求出N次匹配的平均失真, 找出平均失真最小的那个码书, 该码书所对应的单词就是所识别出来的单词. 匹配过程可描
述如下: 
设单词库中有V个单词, 系统共有V个码书, 每个码书包含K个码字, 所以第i个单词的第k个码字可表示为yi, k=0, 1, 2, **, K-1, iwu1, 2, , V. 而输入单词的N个输入矢量为x=1, 2, , N, 则对于第i个码书有: 
 (1) 初始状态s: 第一个输入矢量的最小失真为
d (1, 0) -mind (x1, P) =d (xj, xih) 
 (7-71) 
 (2) 下一个状态$z: 它由前一个状态s和前次识别结果々决定, 即 sz= f (kovsp) 
 (7-72) 在该状态下, 第二个输入矢量的失真为
d (2, 1) = mind (xz, N) =d (*z, $) 
 (7-73) 即与第i个码书的匹配中, 输入的第二个矢量ょ2与该码书第k个码字的失真是最小的. 
 (3) 决定下一状态sz: sg=f (kjwsz) 
 (7-74) 
sn=f (kN-2+SN-1) 
 (7-75) 
d (N, N-1) -d (xn, y'w-.) 
 (7-76) 式中, ko, ki, *"*, kn_1是输入单词的各矢量经N次匹配后输出的码字索引. 上述过程一直进行到输入的N个矢量都匹配完毕为止. 显然, 得出的不同码字索引数至多只有K个. 因此, 第i个码书对输入单词的平均失真为D, =→2d (x; , x_.) 
 (7-77) 与此同时, 该输入单词的各矢量也对其他码书进行上述运算, 则该系统的识别输出的单词将是
i"= arg min D; 
 (7-78) 由式 (7-72) 可知, 系统每次只选择一个下一状态, 即索引砌的下一状态索引为た. 
而在训练码书和求状态转移函数时则存在多种可能, 即索引石的状态是sz的一种可能, 索引南的状态只是一个概率最大的状态. 
下面介绍一种将矢量量化器作为前处理器的混合型语音识别系统, 该系统称为VQ/HMM 孤立单词识别系统[36], 如图7-21所示. 首先, 从LPC训练矢量集中, 用c均值聚类算法得到 LPC 矢量码书和单词的隐马尔可夫模型; 然后, 在测试过程中, 由矢量量化器将输入的测试语音信号量化为有限集合中的离散序列, 把此序列作为识别器 (含Viterbi 计数和判别) 的翰入. 识别时不作DTW匹配计算, 而用各单词的隐马尔可夫模型计算Viterbi 得分. 由于在计算Viterbi 得分之前用矢量量化器作预处理, 将概率密度函数变成概率矩阵, 故可使计算量大为减少. 这样
一来, 在单词识别时使用的是码字索引, 而不是码字本身, 故这种方法能压缩数据. 但是, 由于VQ有量化误差, 故识别精度有所下降. 


## 4.矢量量化在说话人识别中的应用

说话人识别是一种特殊的语音识别, 其目的不是识别说话内容, 而是识别说话人. 说话人识别不注重语音信号的语义, 而从语音信号中提取个人特征, 即提取语音信号中所包含的个性因素. 近年来, 与文本有关的说话人确认系统巳商品化, 已在许多需要进行身分验证的场所得到应用. 但仍有许多问题尚需解决, 其中最关键的问题是; 究竟用语音信号的哪些特征或特征变换描述说话人才有效且可靠. 说话人识别有两种, 即说话人确认和说话人辨认, 如图7-22所示. 说话人确认与说话人辨认之间有相似之处, 也有不同之处. 前者用来判断说话人是否为指定的某人, 它只需用一个特定模板和待识别的测试语音进行匹配, 系统只做出“是”或“不是”的
二元判断. 后者的目的是从已知的一群人中识别出其中的某人, 它一共需要用N个模板, 系统必须辨认出待识别的语音是N个说话人中的鄂一位所有, 有时还要求对这N个说话者以外的测试语音做出正确的判断. 说话人辨认系统最重要的性能指标是识别率, 即正确识别出说话人是谁的百分比. 说话人识别的基本原理和方法与前述的语音识别相同, 也是通过话音的不同特征根据判断逻辑来判定语音的类型, 但是它具有如下自身特点:  (1) 话音按说话人划分, 因而特征空间也应按说话人划分;  (2) 应该采用容易区分不同说话人的特征参量;  (3) 由于说话人识别的目的是识别出说话人而不是所发的语音含义, 故采取的方法也应有所不同, 包括用以比较的帧和帧长的选定, 识别逻辑的制定等. 下面首先介绍说话人识别系统的结构和原理, 然后介绍两种说话人识别方法. 

### 4.1.说话人识别系统的结构和原理

图7-23给出说话人识别的基本结构, 其中特征提取是第一步. 这里的特征提取往往要求舍去语义信息而保留个人特征信息. 声音中包含的个人特征信息有两种; 一种由声道长度, 声带等先天性发音器官的个人差别产生; 另一种由方言, 语调等后天性讲话习惯产生. 前者以共振峰频率高低, 带宽大小, 平均基频, 频谱基本形状的斜率等特征来表现; 后者以基频, 共振峰频率的时间图案, 单词的时间长短等特征来表现. 总的来看, 说话人识别所用的特征包括:  (1) 语音帧能量.  (2) 基普周期. 现已证实, 基音周期及其派生参数携带较多的个人特征信息. 尤其是对汉语这种“有调”语种, 一个字的基普周期的变化即声调, 就是一种重要的相当稳定的个人特征参数.  (3) 帧短时谱或BPFG 特征 (包括14~16个BPF) . 许多情况下采用滤波器组获得频谱信息. 历史上, 滤波器组曾是频谱僧息的首要来源.  (4) 线性预测系数LPC.  (5) 共振峰频率及带宽.  (6) 鼻脅联合特征.  (7) 谱相关特征.  (8) 相对发音速率特征.  (9) LPC倒谱.  (10) 音调轮廓特征.  (11) K-L特征等等. 与一般用于模式识别的特征一样, 这些特征应该具有区分性, 稳定性和独立性. 此外, 还要求不易棋仿性和易测量性. 特征参数的选择应较好地反映说话人的个人特征: 即要求对于同一个人, 这些特征弁数最好能集中在特征空间的某一区域, 或者说方差很小; 而对于不同的人则要求方差很大. 特征类型的有效性可用“F比”来表征, 它代表对某规定的语音而言, 不同说话人发音的某特征的均方差与同一说话人各次发音的该特征的均方差之比, 即

是第i个说话人的各次特征的估计均值, 而 u=<ps> (7-81) 是将所有说话人的两平均所得的均值, 
从语音波形中提取特征之后, 计算与预先存储的各说话人登记的标准模式的距离或相似度, 并根据程度作出判断. 说话人辨认系统先计算输入语音与模式库中各说话人的标准模式之间的距离测度, 然后找到最小测度所对应的说话人. 像大多数识别器一样, 说话人确认系统先计算输入语音同模式库中的说话人的标准模式之间的距离测度, 并将这个距离与预先设定的阚值进行比较, 根据其关系进行判断. 
说话人确认有4种可能的组合, 表7-2表示这4种组合所发生的概率定义. 当未知语音确实是本人语音时, 状态定义为s, 当未知语音为非本人语音时, 定义为n. 若对上述两种状态的接受定义为S, 拒绝定义为N, 则4种可能的组合为P (S| s) , P (S|n) , P (N|s) , P<N|n) . 其中, P (S|) 表示正确接受的概率; P (S|n) 表示错误接受的概率, 简写为FA; P (N|s) 表示正确拒绝的概率; P (N|n) 表示错误拒绝的概率, 简写为FR. 由于存在如下关系: 
P (S|s) + P (N|s) =1
 (7-82) 
P (S|n) + P (N|n) =1
 (7-83) 故只需采用P (S|s) 和P (S|n) 就可评价识别系统的性能. 若将P (S|s) 和 P (S|n) 作为機坐标和纵坐标, 并改变阚值, 则能得到如图7-24所示的ROC曲线. 显然, 方法B优于方法A, 而方法D相当于没有识别能力的情况. 

说话人确认系统最重要的两个性能指标是错误拒绝率和错误接受率. 判决门限和两种错误概率的关系如图7-25所示. 在图 7-24和图7-25中; 点对应于判决门限较小的情况, b点对应判决门限较大的情况. 根据使用场合的不同, 这两类差错造成的影响也不同. 比如在非常机密场所中, 应使错误接受率尽量低, 以免非法进入者造成严重后果. 一般错误接受率要在0, 1%以下, 这样错误拒绝率会略有上升, 但这可通过一些辅助手段来弥补. 在大量使用者利用电话访问公用数据库的情况下, 由于缺少对使用者环境的控制手段, 错误拒绝率过高会造成用户不满, 但错误的接受却不至于引起严重后果. 这时可将错误拒绝率定在1%以下, 相应的错误接受率则会略有上升. 通常, 判决门限设定于两种错误概率相等时所对应的点上, 如图中的c点, 称其为等差错阈值, 用此时的错误率来进行性能评价. 


### 4.2.基于动态时间规整的说话人识别

说话人识别系统可基于模式匹配, HMM 和人工神经网络模型来实现. 识别中的一些方法与语音识别类似, 如用DTW或VQ技术来处理动态时间匹配问题. 但
是, 一方面由于说话人识别有“与文本有关”和“与文本无关”等问题, 另一方面是识别出说话人, 而不是输出语音的含义, 所以与语音识别也有些差异. 概括地说, 对于与文本有关的识别主要采用vQ, 将输入特征序列逐个与VQ的各码书中码字比较, 然后将距离累加作为识别依据, 而不考虑时序, 从而与被识别的语音的音素顺序无关. 由于人的语音是随生理, 心理和健康的状况而变化, 不同时间下的语音会有所不同. 因此, 如果说话人识别系統的训练时间与使用时间相差过长, 则会使系统的性能明显下降. 这是说话人识别系统与一般语音识别系统的一个不同之处. 下画结合实际系统例子讨论说话人识别中所采用的两类识别方法, 即基于DTW的说话人识别以及基于VQ的说话人识别. 这一小节讨论前者, 下一小节讨论后者. 基于DTW的说话人识别系统通常用于说话人确认中, 与文本有关并且要求说话人在每个规定语音音节之间略有停顿. 该系統所使用的特征是BPFG (附听觉特征处理) , 用DTW算法进行动态时间匹配. 其特点为:  (1) 在结构上基本沿用语音识别系统.  (2) 利用正在使用的数据惨正原棋板, 即在某次使用过程中某说话人被正确证实时, 使用此时的输入特征对原模板作加权修改 (一般用1/10加权) , 这样可使模板逐渐趋于完善. 系统框图如圈7-26所示. 采样时间间隔为 2.5ms, 所存的字音模板数为15X16, 即15个说话人各自的16个规定音. 建立模板时, 每个说话人对各宇音各发10次再经过适当平均得到上述的各模板, 在确认过程中, 要求待确认者在他已知的16个字音中任选2~4个.先任选2字, 将2个字所得的“计分” (距离的倒数) 相加, 若已超过判决逻辑中所选定的阔值则予以肯定. 否则, 令待确认者另选16个字中其他字音并将计分加权累加, 直到共发4个字音. 若仍未达到阙值, 则予以拒绝. 典型的试验结果为: 对于1732个训练集内的待确认者, 经此系统识别的错误拒绝率为0.6%; 对于630个训练集外的待证实者, 错误接受率为0.3%. 当然, 适当改变阈值可谰整这两种比率. 

### 4.3.基于矢量量化的说话人识别

矢量量化技术在说话人识别中也有重要应用, 采用VQ可避兔困难的语音分段问题和时间规整问题, 且作为一种数据压缩手段可大大减少系统所需的数据存储量. 此外, VQ的分类特性还可有效地作为辨识说话人的一种手段. 人们可将每个待辨识的说话人看作一个信源, 用一个码书来表征, 码书是由从该说话人的训练序列中提取的特征矢量聚类而生成, 只要训练序列足够长, 可认为这个码书能有效地包含说话人的个人特征, 而与讲话内容无关. 对于N个说话人的系统, 需要建立N个码书. 识别时, 先从待识别的语音中分析出一组测试矢量, 用每一个码书依次对它们进行矢量量化, 计算各自的平均量化失真
D, -Mmi[d (xn, X) ]
1さ
 (7-84) 式中, y{od=1, 2, **, L, i=-1, 2, *, N 是第i个码书中的第1个码字, 而d (x., y) 是
待测矢量x. 和码字y之间的距离. 选择满足D, 最小的那个码书所对应的i作为系统辨认结果. 特征矢量仍可选用反映语音信号短时谱特性的LPC系数, 倒谱参数等. VQ无论在“与文本无关”或“与文本有关”的识别中, 都是一种有力工具. 图
7-27所示的系统是应用LPC 特征的VQ型说话人辨识系统. 该系统对每个说话人建立一个VQ码书. 应用此系统的说话人数用N来表示. 在训练时, 根据每一个说话人所发语音计算各 LPC 特征向量, 通过VQ聚类得到该说话人的码书, 其码字数为M. 在聚类过程中所用的距离测度为LPC似然比失真测度, 即令矢量a, b间的距离为

式中, R. 为向量a的自相关矩阵. 在辨认过程中, 将待识别语音帧特征序列a, ***, 
az对第i个说话人按式 (7-84) 求总距离, 然后以D;  (i=1, 2, , N) 中最小者相应的说话人作为辨认的结果. 

在仿真实验中, 系统的发音内容为: 由100个说话人 (男女各半) 在4个月内均匀分4饮由电话线以隨机组合的数字串形式记录各200个孤立字音, 即10个英文数字 (0~9) 每字20次. 其中100个用来训练, 另100个則用来测试. 因为测试语句可能是任意次序排列的数字串, 所以这个实验也部分地反映了“与文本无关”的说话人辨认情况. 进入系统的语音先经200~3200Hz的带通滤波, 再以6.67kHz取样率取样, 又经一传输函数为H (z) =1-0.95z一'的一阶滤波器加重. 所用窗为45ms宽度的Hamming窗, 帧长30ms (15ms重叠) . 毎帧特征为8阶LP C (先计算出各阶自相关系数) . 所进行的主要实验有:  (1) 审査采用不同码书数2『 (R称为码书率) 时的误确认率 (R=1, 2, , 6) ; 
 (2) 审查不同的发音内容对误辨认率的影响. 所用的发音内容有4种情况; 任选10个数字之一, 任选2个不同数字, 任选4个不同数字和用全部10个数字. 在上述情况下作辨认实验所得的结果综合起来如图7-28所示. 由图可见, 随着码书个数增加和测试语音变长, 误辨认率迅速下降. 当用全部10个数字为发音内容而码书分辨率为6 (即码书数为64) 时, 误辨认率可降到1.5%.